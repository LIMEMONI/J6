<!DOCTYPE html>
<html lang="en">
<head>
    <title>MainㅣFALP Service</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <!-- VENDOR CSS -->
    <link rel="stylesheet" href="/static/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/vendor/linearicons/style.css">
    <link rel="stylesheet" href="/static/vendor/chartist/css/chartist-custom.css">
    <!-- MAIN CSS -->
    <link rel="stylesheet" href="/static/css/main.css">
    <!-- FOR DEMO PURPOSES ONLY. You should remove this in your project -->
    <link rel="stylesheet" href="/static/css/demo.css">
    <!-- GOOGLE FONTS -->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700" rel="stylesheet">
    <!--구글 폰트 추가-->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Karla:wght@200&family=Noto+Sans+KR:wght@400;500&display=swap" rel="stylesheet">
    <!--구글 폰트 끝-->
    <!-- ICONS -->
    <link rel="apple-touch-icon" sizes="76x76" href="/static/img/j6.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/static/img/top-icon.png">
    <!-- D3.js 라이브러리 추가 -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/static/js/slimscroll.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/02c33e7f68.js" crossorigin="anonymous"></script>
    <script>
        // JavaScript로 설정한 시작 시간으로부터 1초씩 시간을 증가시키는 함수
        function startCountingRuntime(startTime, elementId) {
            const startTimeObj = new Date(startTime);
            setInterval(function() {
                startTimeObj.setSeconds(startTimeObj.getSeconds() + 1); // 1초를 더합니다.
                const hours = startTimeObj.getUTCHours();
                const minutes = startTimeObj.getUTCMinutes();
                const seconds = startTimeObj.getUTCSeconds();
                document.getElementById(elementId).textContent = `${hours}시간 ${minutes}분 ${seconds}초`;
            }, 1000);
        }
        $(document).ready(function() {
            // 알람 드롭다운 메뉴 토글 이벤트 위임
            $(document).on("click", "#alarmDropdownButton", function() {
                $(".notifications").toggle();
        });

        // "더 보기" 버튼 클릭 이벤트 위임
        $(document).on("click", ".view-more", function() {
                window.location.href = "/alram.html";
        });
        });

        // 페이지가 로드된 후 함수 실행
        // 10초마다 새로운 데이터를 db에서 가져오는 함수
        window.onload = function() {
            setInterval(async function(){
                let response = await fetch("/main.html");
                let text = await response.text();
                document.body.innerHTML = text; // 화면 갱신
            }, 10000); // 10초 간격
        };
        // 시작 시간과 element ID를 전달하여 가동시간 증가 카운트 시작
        startCountingRuntime("{{ start_times['설비 1'] }}", "tool1_runtime");
        startCountingRuntime("{{ start_times['설비 2'] }}", "tool2_runtime");
        startCountingRuntime("{{ start_times['설비 2'] }}", "tool3_runtime");
        startCountingRuntime("{{ start_times['설비 2'] }}", "tool4_runtime");
    </script>
    <script>
        $(document).ready(function() {
            // 알람 드롭다운 메뉴를 토글하기
            $("#alarmDropdownButton").click(function() {
                $(".notifications").toggle();
            });
    
            // "더 보기" 버튼을 클릭했을 때 이벤트 처리
            $(".view-more").click(function() {
                // "alram.html"로 이동
                window.location.href = "alram.html";
            });
        });
    </script>
    <style>

        /**********
        * main.html의 clock
        *********/

        
        #current_date {
            text-align: center;
            font-family: 'IBM Plex Sans KR', sans-serif;
            font-family: 'Jua', sans-serif;
            font-family: 'Karla', sans-serif;
            margin: 20px;
            padding-top: 10px;
        }
        
        #current_date .date {
            font-size: 20px;
            color: #3287B2;
            font-weight: bold; /* 날짜 텍스트를 굵게 설정 */
        }
        
        #current_date .time {
            font-size: 40px;
            color: #3287B2;
            font-weight: bold; /* 시간 텍스트를 굵게 설정 */
        }
        /*안내용 범례*/
        .legend{
            border: 3px solid white;
            border-radius: 10px;
            margin-left: 0%; 
            color: #59616D;
            width: 220px;
            height: 300px;
            margin-bottom: 1px;
            margin-left: 5%;
        }
        /*설비 박스 영역*/
        .panel-board{
            border: 6px solid green;
            border-radius: 25px; /* 원하는 모서리 둥근 정도를 조절할 수 있습니다. */
            color: gray;
            width: 100%;
            height: 250px;
            margin-bottom: 28px;
        }
        /*설비 이름 영역*/
        .panel-heading{
            color:black;
        }
        /*설비 박스 내 아이콘 영역*/
        .tool-icon{
            width: 150px; 
            height: 150px;
            display: inline;
        }
        /*설비 박스 내 텍스트 영역*/
        .panel-body-text{
            margin-left: 25%;
            display: inline;
            color: #2B333E;
        }
        /*설비 박스 사이 벽*/
        .wall{
            background-color: #392f31;
            width: 500px;
            height: 25px;
            margin-bottom: 28px;
        }
        /*설비 이름 - 표시값 구분선*/
        .head-line{
            margin-top: 0%; 
            margin-bottom: 0%; 
            height: 10px; 
            border: none; 
            border-top: 2px solid #565454;
        }
        /*설비 작동중 표시원*/
        .normal-status-topRight {
            display: flex;
            align-items: center;
        }
        .abnormal-status-topRight {
            display: flex;
            align-items: center;
        }
    </style>
    <style>
        /* 알람 갯수를 표시하는 숫자 스타일 */
        .alarm-count-badge {
            position: absolute;
            top: 23px;
            right: 5px;
            background-color: red;
            color: white;
            width: 20px; /* 숫자 너비 조정 */
            height: 15px; /* 숫자 높이 조정 */
            border-radius: 50%;
            font-size: 11px; /* 숫자 크기 조정 */
            text-align: center; /* 가운데 정렬을 위한 설정 */
            line-height: 15px; /* 숫자 높이와 같도록 설정 */
            font-weight: bold;
        }
    </style>  
</head>

<body>
    <!-- WRAPPER -->
    <div id="wrapper">
        <div class="row">
            <div class="col-md-12">
                <!-- NAVBAR -->
                <nav class="navbar navbar-default navbar-fixed-top"  style="height: 12%;">
                    <!-- 로고와 데이터 불러오기 버튼 -->
                    <div class="navbar-header">
                        <!-- 오른쪽 메뉴 아이콘들 --> 
                        <div class="container-fluid" style="display: flex; justify-content: flex-end;">     
                            <div id="navbar-menu">
                                <a class="navbar-brand" style="width: 15%; height: 15%; margin-top: 20px; display: flex; align-items: center;">
                                    <img src="static/img/logo2.png" alt="J6 Logo" class="img-responsive logo">   
                                </a>
                                <div class="navbar-btn">
                                    <button type="button" class="btn-toggle-fullwidth" style="font-size: 25px;"><i class="lnr lnr-arrow-left-circle"></i></button>
                                </div>
                                <ul class="nav navbar-nav navbar-right">
                                    <li style="margin-right: 10px;"><a href="main.html"><i class="fa-solid fa-house"></i></a></li>
                                    <li style="margin-right: 10px;"><a href="dashboard.html"><i class="fa-solid fa-chart-line"></i></a></li>
                                    <li class="dropdown">
                                        <a href="#" class="dropdown-toggle icon-menu" data-toggle="dropdown" id="alarmDropdownButton">
                                            <i class="fa-solid fa-bell"></i>
                                        </a>
                                    <!-- 알람 드롭다운 메뉴 -->
                                    <ul class="dropdown-menu notifications">
                                        {% for item in bar_lis[:5] %}
                                            {% set val = item[0] %}
                                            {% set i_s = item[1] %}
                                            {% set i_e = item[2] %}
                                            <li><a class="notification-item" href="/alram.html?time={{ val }}&xlim_s={{ i_s }}&xlim_e={{ i_e }}"> 공정 이상 감지 구간 : {{ val }}</a></li>
                                        {% endfor %}
                                        <li><a class="view-more" style="text-align: center;" href="/alram.html?time={{ bar_lis[0][0] }}&xlim_s={{ bar_lis[0][1] }}&xlim_e={{ bar_lis[0][2] }}" ><i class="lnr lnr-alarm" ></i> 더 보기</a></li>
                                    </ul>
                                    <span class="alarm-count-badge">{{ bar_lis|length }}</span>
                                    </li>
                                    <!-- 나머지 메뉴 아이콘들 -->
                                    <li class="dropdown">
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                            <li><a href="profile.html"><img src="static/img/user1.png" class="img-square" alt="Picture"><span style="font-weight: bold;">{{ mem_name }}</span></a></li>
                                        </a>
                                        <li><a href="/"><i class="fa-solid fa-arrow-right-from-bracket"></i><span style="font-weight: bold;">Logout</span></a></li>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        
                    </div>
                </nav>
            </div>
        </div>
        <!-- END NAVBAR -->

    <!-- LEFT SIDEBAR -->
    <div id="sidebar-nav" class="sidebar">
        <div class="sidebar-scroll">
            <nav>
                <!-- 각 탭 버튼 -->
                <ul class="nav" id="myTabs">
                    <!-- 빈약한 main page를 실시간 시간을 알려주는 걸로 채워봅시다 ㅇ.< -->
                    <div id="current_date">
                        <span class="date"></span><br>
                        <span class="time"></span>
                    </div>
                </ul>

                <div class="text-center" style="position: absolute; bottom: 20px; width: 100%;">
                    <!-- LEGEND -->
                    <div class="legend">
                        <span style="color: white;"><b>※ NOTICE </b></span>
                        <hr style="border: 1px dashed white">
                        <div class="legend-item">
                            <div class="legend-row">
                                <div>
                                    <span style="color: white;"><b>[ Power ]</b></span>
                                </div>
                                <br>
                                <div class="legend-col">
                                    <i class="fa-solid fa-power-off fa-fade" style="color: #93db93; margin-right: 4px;"></i>
                                    <span style="color: white;"><b>설비 가동중</b></span>
                                </div>
                            </div>
                            <div class="legend-row">
                                <div class="legend-col">
                                    <i class="fa-solid fa-power-off" style="color: white; margin-right: 4px;"></i>
                                    <span style="color: white;"><b>설비 정지</b></span>
                                </div>
                            </div>
                        </div>
                        <hr style="border: 1px dashed white">
                        <div class="legend-item">
                            <div class="legend-row">
                                <div>
                                    <span style="color: white;"><b>[ Process Condition ]</b></span>
                                </div>
                                <br>
                                <div class="legend-col">
                                    <i class="fa-regular fa-square" style="color: #93db93; margin-right: 4px;"></i>
                                    <span style="color: white;"><b>Normal</b></span>
                                </div>
                            </div>
                            <div class="legend-row">
                                <div class="legend-col">
                                    <i class="fa-regular fa-square" style="color: #f26464; margin-right: 4px;"></i>
                                    <span style="color: white;"><b>Near Abnormal</b></span>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                    <!-- END LEGEND -->
                </div>
            </nav>
        </div>
    </div>
    <!-- END SIDEBAR -->
		<!-- MAIN -->
		<div class="main">
			<!-- MAIN CONTENT -->
			<div class="main-content" style="margin-right: 12%;">
				<div class="container-fluid">  
                    <div class="row">
                        <div class="col-md-6">
                            <!-- BASIC TABLE -->
                            <div class="panel-board" id="Ion_Miller_M01" 
                            style="{% if tool1_status == 0 %} border: 6px solid #93db93; margin-left: 42px;
                                {% elif tool1_status == 1 %} border: 6px solid #f26464; margin-left: 42px;
                                {% endif %}">
                            
                                <a id="tool1_link" href="dashboard.html?tab=dashboard1" style="color: #392f31;"> <!-- M01설비의 Dashboard 페이지로 이동 -->
                                    <div class="panel-heading">
                                        <!--상태표시 초록원-->
                                        <span class="normal-status-topRight">
                                            <i class="fa-solid fa-power-off fa-fade"
                                            style="{% if tool1_status == 0 %} color : #93db93; margin-right : 10px;
                                            {% elif tool1_status == 1 %} color : #f26464; margin-right : 10px;
                                            {% endif %}"></i>
                                            <h3 class="panel-title"><b>Ion_Miller_M01</b></h3>
                                        </span> 
                                    </div>
                                    <hr class="head-line"> <!--설비 이름-내용 구분선-->
                                    <div class="panel-body" style="display: flex; align-items: center;">
                                        <!-- 설비 아이콘 -->
                                        <img class="tool-icon" src="static/img/tool.png"> 
                                        <!-- 설비 상태 텍스트 -->
                                        <div style="display: flex; flex-direction: column; width: 250%;">
                                            <span class="panel-body-text">
                                                - <b>공정 이상 여부</b> :
                                                {% if tool1_status == 0 %}
                                                정상
                                                {% else %}
                                                <span style="color: rgb(37, 208, 227); margin-left: 5px;">{{tool1_status_index}}!</span>
                                                {% endif %}
                                            </span>
                                            <span class="panel-body-text">
                                                - <b>잔여 수명 시간</b> : {{tool1_rul}}
                                            </span>
                                            <span class="panel-body-text">
                                                - <b>가동 시간</b> : 
                                                {% if  tool1_status == 0 %}
                                                <span id="tool1_runtime"></span>
                                                {% else %}
                                                --
                                                {% endif %}
                                            </span>
                                            <span class="panel-body-text">
                                                - <b>recipe</b> :
                                            </span>
                                            <span class="panel-body-text">
                                                - <b>stage</b> :
                                            </span>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <!-- END BASIC TABLE -->
                        </div>
                        <div class="col-md-6">
                            <!-- BASIC TABLE -->
                            <div class="panel-board" 
                                style="{% if tool2_status == 0 %} border: 7px solid #90DA80; margin-left: 42px;
                                {% elif tool2_status == 1 %} border: 7px solid #f26464; margin-left: 42px;
                                {% endif %}">
                            <a id="tool2_link" href="dashboard.html?tab=dashboard2" style="color: #392f31;"> <!-- M02설비의 Dashboard 페이지로 이동 -->
                                <div class="panel-heading" style="">
                                    <!--상태 표시 초록원-->
                                    <span class="normal-status-topRight">
                                        <i class="fa-solid fa-power-off fa-fade"
                                        style="{% if tool2_status == 0 %} color : #93db93;  margin-right : 10px;
                                        {% elif tool2_status == 1 %} color : #f26464; margin-right : 10px;
                                        {% endif %}"></i>
                                        <h3 class="panel-title"><b>Ion_Miller_M02</b></h3> <!--설비 이름-->
                                    </span>
                                </div>
                                <hr class="head-line"> <!--설비 이름-내용 구분선-->
                                <div class="panel-body" style="display: flex; align-items: center;">
                                    <img class="tool-icon" src="static/img/tool.png">
                                    <div style="display: flex; flex-direction: column; width: 250%;">
                                        <span class="panel-body-text">
                                            - <b>공정 이상 여부</b>:
                                            {% if tool2_status == 0 %}
                                            정상
                                            {% else %}
                                            <span style="color: rgb(37, 208, 227); margin-left: 5px;">고장!</span>
                                            {% endif %}
                                        </span>
                                        <span class="panel-body-text">
                                            - <b>잔여 수명 시간</b> : {{tool2_rul}}
                                        </span>
                                        <span class="panel-body-text">
                                            - <b>가동 시간</b> : 
                                            {% if  tool2_status == 0 %}
                                            <span id="tool2_runtime"></span>
                                            {% else %}
                                            --
                                            {% endif %}
                                        </span>
                                        <span class="panel-body-text">
                                            - <b>recipe</b> :
                                        </span>
                                        <span class="panel-body-text">
                                            - <b>stage</b> :
                                        </span>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <!-- END BASIC TABLE -->
                        </div>
                        
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <!-- TABLE STRIPED -->
                            <div class="panel-board" 
                                style="{% if tool3_status == 0 %} border: 6px solid #93db93; margin-left: 42px; 
                                {% elif tool3_status == 1 %} border: 6px solid #f26464; margin-left: 42px;
                                {% endif %}">
                                <a id="tool3_link" href="dashboard.html?tab=dashboard3" style="color: #392f31;"> <!-- M03설비의 Dashboard 페이지로 이동 -->
                                    <div class="panel-heading">
                                        <!--상태 표시 초록원-->
                                        <span class="normal-status-topRight">
                                            <i class="fa-solid fa-power-off fa-fade"
                                            style="{% if tool2_status == 0 %} color : #93db93;  margin-right : 10px;
                                            {% elif tool2_status == 1 %} color : #f26464; margin-right : 10px;
                                            {% endif %}"></i>
                                            <h3 class="panel-title"><b>Ion_Miller_M03</b></h3>
                                        </span> 
                                    </div>
                                    <hr class="head-line"> <!--설비 이름-내용 구분선-->
                                    <div class="panel-body" style="display: flex; align-items: center;">
                                        <img class="tool-icon" src="static/img/tool.png">
                                        <div style="display: flex; flex-direction: column; width: 250%;">
                                            <span class="panel-body-text">
                                                - <b>공정 이상 여부</b> :
                                                {% if tool3_status == 0 %}
                                                정상
                                                {% else %}
                                                <span style="color: rgb(37, 208, 227); margin-left: 5px;">고장!</span>
                                                {% endif %}
                                            </span>
                                            <span class="panel-body-text">
                                                - <b>잔여 수명 시간</b> : {{tool3_rul}}
                                            </span>
                                            <span class="panel-body-text">
                                                - <b>가동 시간</b> : 
                                                {% if  tool3_status == 0 %}
                                                <span id="tool3_runtime"></span>
                                                {% else %}
                                                --
                                                {% endif %}
                                            </span>
                                            <span class="panel-body-text">
                                                - <b>recipe</b> :
                                            </span>
                                            <span class="panel-body-text">
                                                - <b>stage</b> :
                                            </span>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <!-- END TABLE STRIPED -->
                        </div>
                        
                        <div class="col-md-6">
                            <!-- TABLE HOVER -->
                            <div class="panel-board" 
                                style="{% if tool4_status == 0 %} border: 6px solid #93db93; margin-left: 42px;
                                {% elif tool4_status == 1 %} border: 6px solid #f26464; margin-left: 42px;
                                {% endif %}">
                                <a id="tool4_link" href="dashboard.html?tab=dashboard4"> <!-- M04설비의 Dashboard 페이지로 이동 -->
                                    <div class="panel-heading">
                                        <span class="abnormal-status-topRight">
                                            <i class="fa-solid fa-power-off fa-fade"
                                            style="{% if tool2_status == 0 %} color : #93db93;  margin-right : 10px;
                                            {% elif tool2_status == 1 %} color : #f26464; margin-right : 10px;
                                            {% endif %}"></i>
                                            <h3 class="panel-title"><b>Ion_Miller_M04</b></h3>
                                        </span> 
                                    </div>
                                    <hr class="head-line"> <!--설비 이름-내용 구분선-->
                                    <div class="panel-body" style="display: flex; align-items: center;">
                                        <img class="tool-icon" src="static/img/tool.png">
                                        <div style= "display: flex; flex-direction: column; width: 250%;">
                                            <span class="panel-body-text" style="display: flex; align-items: center;">
                                                - <b>공정 이상 여부</b> :
                                                {% if tool4_status == 0 %}
                                                정상
                                                {% else %}
                                                <span style="color: rgb(37, 208, 227); margin-left: 5px;">고장!</span>
                                                {% endif %}
                                            </span>
                                            <span class="panel-body-text">
                                                - <b>잔여 수명 시간</b> : {{tool4_rul}}
                                            </span>                                            
                                            <span class="panel-body-text">
                                                - <b>가동 시간</b>: 
                                                {% if  tool4_status == 0 %}
                                                <span id="tool4_runtime"></span>
                                                {% else %}
                                                --
                                                {% endif %}
                                            </span>
                                        <span class="panel-body-text">
                                            - <b>recipe</b> :
                                        </span>
                                        <span class="panel-body-text">
                                            - <b>stage</b> :
                                        </span>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        <!-- END TABLE HOVER -->
                    </div>                 
			</div>
			<!-- END MAIN CONTENT -->
		</div>
		<!-- END MAIN -->
		<div class="clearfix"></div>
		<footer>
			<div class="container-fluid">
				<p class="copyright">Made by <i class="fa fa-love"></i><a href="https://bootstrapthemes.co">J6</a>
</p>
			</div>
		</footer>
	</div>
	<!-- END WRAPPER -->
	<!-- Javascript -->
    <script>
        // 페이지가 로드될 때 실행되는 함수
            document.addEventListener("DOMContentLoaded", function () {
                var tool1_rul = {{tool1_rul}}; 
                var tool2_rul = {{tool2_rul}}; 
                var tool3_rul = {{tool3_rul}}; 
                var tool4_rul = {{tool4_rul}}; 
    
                // tool1 처리
                var tool1Link = document.getElementById("tool1_link");
                if (tool1_rul === 0) {
                    alert("Flowcool Pressure Too High check Flowcool Pump이 발생했습니다.");
                    tool1Link.style.pointerEvents = "none";
                    tool1Link.style.color = "#999"; // 링크의 색상을 회색으로 변경 (비활성화 표시)
                }
    
                // tool2 처리
                var tool2Link = document.getElementById("tool2_link");
                if (tool2_rul === 0) {
                    alert("Flowcool Pressure Too High check Flowcool Pump이 발생했습니다.");
                    tool2Link.style.pointerEvents = "none";
                    tool2Link.style.color = "#999";
                }
    
                // tool3 처리
                var tool3Link = document.getElementById("tool3_link");
                if (tool3_rul === 0) {
                    alert("Flowcool Pressure Too High check Flowcool Pump이 발생했습니다.");
                    tool3Link.style.pointerEvents = "none";
                    tool3Link.style.color = "#999";
                }
    
                // tool4 처리
                var tool4Link = document.getElementById("tool4_link");
                if (tool4_rul === 0) {
                    alert("Flowcool Pressure Too High check Flowcool Pump이 발생했습니다.");
                    tool4Link.style.pointerEvents = "none";
                    tool4Link.style.color = "#999";
                }
            });
        </script>
    <script>
        // JavaScript로 설정한 시작 시간으로부터 1초씩 시간을 증가시키는 함수
        function startCountingRuntime(startTime, elementId) {
            const startTimeObj = new Date(startTime);
            setInterval(function() {
                startTimeObj.setSeconds(startTimeObj.getSeconds() + 1); // 1초를 더합니다.
                const hours = startTimeObj.getUTCHours();
                const minutes = startTimeObj.getUTCMinutes();
                const seconds = startTimeObj.getUTCSeconds();
                document.getElementById(elementId).textContent = `${hours}시간 ${minutes}분 ${seconds}초`;
            }, 1000);
        }
        $(document).ready(function() {
            // 알람 드롭다운 메뉴 토글 이벤트 위임
            $(document).on("click", "#alarmDropdownButton", function() {
                $(".notifications").toggle();
        });

        // "더 보기" 버튼 클릭 이벤트 위임
        $(document).on("click", ".view-more", function() {
                window.location.href = "/alram.html";
        });
        });

        // 페이지가 로드된 후 함수 실행
        // 10초마다 새로운 데이터를 db에서 가져오는 함수
        window.onload = function() {
            setInterval(async function(){
                let response = await fetch("/main.html");
                let text = await response.text();
                document.body.innerHTML = text; // 화면 갱신
            }, 10000); // 10초 간격
        };
        // 시작 시간과 element ID를 전달하여 가동시간 증가 카운트 시작
        startCountingRuntime("{{ start_times['설비 1'] }}", "tool1_runtime");
        startCountingRuntime("{{ start_times['설비 2'] }}", "tool2_runtime");
        startCountingRuntime("{{ start_times['설비 2'] }}", "tool3_runtime");
        startCountingRuntime("{{ start_times['설비 2'] }}", "tool4_runtime");
    </script>
    <script>
        function formatAMPM(date) {
            var hours = date.getHours();
            var minutes = date.getMinutes();
            var seconds = date.getSeconds();
            var ampm = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12;
            hours = hours ? hours : 12;
            hours = hours < 10 ? '0' + hours : hours;
            minutes = minutes < 10 ? '0' + minutes : minutes;
            seconds = seconds < 10 ? '0' + seconds : seconds;
            return ampm + ' ' + hours + ':' + minutes + ':' + seconds;
        }
        
        function updateClock() {
            var date = new Date();
            var year = date.getFullYear();
            var month = date.getMonth() + 1;
            var day = date.getDate();
            var formattedTime = formatAMPM(date);
        
            document.querySelector("#current_date .date").innerHTML = year + '/' + month + '/' + day;
            document.querySelector("#current_date .time").innerHTML = formattedTime;
        }
        
        // 초기에 시간을 업데이트하고, 매 초마다 다시 업데이트합니다.
        updateClock();
        setInterval(updateClock, 1000); // 1초마다 업데이트        
    </script>
	<script src="/static/vendor/jquery/jquery.min.js"></script>
	<script src="/static/vendor/bootstrap/js/bootstrap.min.js"></script>
	<script src="/static/vendor/jquery-slimscroll/jquery.slimscroll.min.js"></script>
	<script src="/static/scripts/klorofil-common.js"></script>
</body>

</html>